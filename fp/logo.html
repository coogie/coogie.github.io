<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Freak Pointing Logo</title>
    <link rel="stylesheet" href="logo.css" />
  </head>
  <body>
    <div class="mode-toggle">
      <button class="mode-btn active" data-mode="svg">Clean</button>
      <button class="mode-btn" data-mode="png">Grunge</button>
    </div>

    <div class="logo-container">
      <canvas id="png-canvas" style="display: none;"></canvas>
      <svg
      xmlns="http://www.w3.org/2000/svg"
      data-name="Freak Pointing Logo"
      viewBox="-20 -20 1326 718"
      overflow="visible"
    >
      <path
        id="color-target"
        fill="#f49de3"
        stroke="#000000"
        stroke-width="0"
        paint-order="stroke fill"
        fill-rule="evenodd"
        d="M2 45c8 51 4 101 7 151 4 52 0 102 1 152 29-1 57 2 84-2 0-23 1-44-2-66 4-22-4-45 2-65 16-4 37 7 47-8-2-17 1-34-3-49-2 1-3-4-5-2H92c-3-3-5 0-4-3-2-17-2-36-1-51 18-6 35-8 52-8 3 0 2-3 2-4 1-19-1-39-2-56-3-2-4-1-6-1-43 9-86 3-129 8-3 0-1 3-2 4Zm167 298c25 2 49 1 73 2 4-1 1-4 4-4 0-37 0-72-2-107 1-11-4-26 3-33 17 2 22 8 21 24-1 12 3 24 1 36 3 25 2 49 2 73 3 12 22 9 32 8 15 0 27-3 40-3 4 0 1-4 4-2 1-33-2-64-2-95 5-39-18-52-34-64 15-9 21-9 25-26 8-14 5-28 6-41 0-29-10-57-24-65-8-11-32-14-48-13l-74-1c-12 2-23 0-35 1-3 0 0 4-3 2 3 103 5 203 9 304-1 4 3 1 2 4Zm72-231c1-10-3-27 9-28 2-1 7 0 9 3 6 6 10 25 8 38-1 8 0 23-6 26-6 5-17 1-19-3-3-10 3-23-1-36Zm1004-54c-1-3-6-2-9-2h-12l-34-2c-8 2-8-4-11-7l-8-14c-2-2-8-2-11-3l-26-5c-5-1-10-2-11 2l-16 16c-7-1-12-5-20-8-7-4-14-5-21-3l-43 3-24-12-19 10-20 9c-8-3-8 4-12 6l-33 40c-3 5-7 7-9 13-2 8-6 16-7 24l10 27c3 5 4 10 0 14l-5 15c-4 13 4 20 9 25l14 6-1 1v2l8 11c3 4 12 4 17 6l38 10c8 3 18 4 25 7l59 43v1l-11 7c-3 6-4 15-5 23l-4 24 12 13c6 3 7 12 18 9l16-1c8 0 16-3 23 0l30 9c8 4 10-2 12-3l25-22c6-10 18-40 24-54 1-3 6-8 3-13l-16-21-1-1-11-14 7 46-35 59c-14-2-27-6-40-9l-40 6c0-1-2 0-1-1v-46l32-17 60 16c-7-6-12-12-19-16-6-4-22-6-28-10-2 0 0-1-1-1l7-16 6-14h-1l-12 13-1-2 19-45 5-15h2c18 7 27 14 48 21 7 0 15 4 20 0l39-46c3-2 6-12 9-20l11-27 11-29v-2l-41-36Zm-236 181h-1l-46-15-15-5 1-1c4 0 11-4 13 0l11 7-1-2-8-8 1-1 16-4-1-2 5-6h2l4 24c0 5 2 6 8 8 3 1 8 4 12 4v1h-1Zm85 41-18-9-26-13-27-13v-1l39 16s1 1 1-1v-10c0-1 0-2 1-1 14 7 28 15 40 25l-10 7Zm50-157c-7 8-15 16-22 26l5 13c1 4 3 6 3 11-5 15-5 35-8 52-1 8 0 17-2 26-1 4 0 9-2 13l-6 7-24-25-24-24 1-31c1-15 9-30 13-45l7-24 4-11c1-4 4-7 2-11l-13-6-2 41-12 19-8 15c-3 11-2 23-4 35l-2 35-1 1-23-6-16-5c-5-1-5-4-7-7l-7-12-3-7-3-2h-2l-1-2c4-6 9-9 11-17l5-28c4-18 4-36 6-54V85l-12 38c-5 15-10 18-15 28-4 5-4 15-4 23l-2 34-31-2c-9-6-15-13-22-20-4-1-2-7-1-11l4-16c7-21 9-42 13-64h-1l-8 19-7 18h-1l-4-21 39-46c8-6 13-15 22-20 4-2 7-2 11-2l11 22 12-6 13-6-1 4s-1 1 1 1l44-4c9-3 10 4 14 8l12 11 28-22 20 6 13 4c6 9 10 20 16 30l-6 7-23 25Zm57 73c-4 0-8-3-13-4l-14-6-10-4c-5-8-9-19-16-28 1-6 5-8 7-12l14-20 21-29c5-12 18-15 29-22 6 1 8 4 13 7l36 21c-22 33-42 67-67 97ZM553 327c15 0 30-1 42-3 4-19-1-39 7-56 6 2 11-1 16-1 16 7 14 39 15 54 28 3 56 0 83-2 0-19-9-40-9-58 0-20-11-39-9-58-10-39-15-77-26-115-1-25-7-55-15-75l-8-4c-35 5-70 1-104 7-10 50-12 100-17 150a2834 2834 0 0 0-13 158c7 10 27-3 38 3Zm57-217-2-4c-2-3-3-4-3-7 0-2-1-4 1-3 3 0 0 2 2 1 6 4 3 18 5 23l4 27c1 19 2 36 6 54 6 19-14 9-23 11-2-2-4-2-5-5 4-32 4-64 10-95l4 3 1-5Zm0 5h-1 1Zm-259-9a4656 4656 0 0 0 25 239c35-10 70-2 104-13 12-1 27 4 34-3-6-20-2-40-6-57 0-2-3 1-4-2-17 1-32-4-47 5-9-3-12-22-13-32 2-13-2-30 4-38 16 3 35-4 47-9-6-17-10-33-8-48-2-2 0-5-3-4-15-7-37 7-48-2-8-15-3-34-3-50 3-2 0-5 3-4 16 1 32-3 47-7-7-20 3-44-8-61l-5 1c-40 6-80 7-119 11-13 4-6 24-4 34 4 15 1 27 4 40Zm370 204c2 5 2 6 4 7 24-4 46 1 68-3 6-2 5-2 7-6-3-38 1-74-1-110 2 0 5-1 4 1v5c12 35 19 74 29 109 2 0 3-1 5 1 27-1 52-3 78-2 0-3 4 0 3-3-12-27-19-53-27-78-11-25-12-57-25-72-6-18 1-35 7-52l20-68c2-13 11-27 10-38l-59-1c-25-1-17 29-27 46-4 20-13 40-13 59-4 3-4 10-8 11 2-34-6-70-1-104-3-13-25-8-35-9-16 0-29-2-43 3-2 2-5-1-3 2 1 101 3 202 7 302ZM172 432c1-14-2-33-9-38-9-10-16-16-30-21-20-9-39-6-58-6-22 1-44-1-66-1-15 1-7 19-8 31v38l3 77c-2 52-1 103 2 153-1 19 22 11 33 12 16-3 39 2 46-8-3-21 1-39-1-58 0-19-3-40 3-56 6-9 23 0 34-5 19-4 35-11 40-18 13-13 10-43 12-62 1-14-2-26-1-38Zm-84 64c-11-5-5-25-7-38 2-11-3-32 7-37 9 0 20 0 18 12l3 41c1 16-7 20-21 22Zm710-157c-4-1-8-3-12-2-2 1-3-1-3 1h-2l-2 1c-18 5-37-1-55 1-18 1-36-2-54-2-11-1-28 1-31 8-4 5-3 15 0 19 1 1 3 5 2 9 0 7-4 18 1 24l13 2c10 0 22 2 29 5 5 2 1 9 1 13-2 7 0 12 0 18 2 13-1 26 0 39 1 15 3 32-2 45l3 24c1 19-3 37 0 55 2 10 3 20-1 30l5 12c2 3 8 4 12 1 4-1 8-5 13-2 8 4 19 4 28 3 7-1 14-1 20-3 1-6-3-13 0-19 2-7 3-13 2-20-8-13 2-31 0-46-4-3-4-12-2-19s0-14 0-21c-3-14 1-28 1-42 0-10-5-19-2-28 2-13-2-25-1-37 2-6 8-8 16-9 8 0 16 4 24 2 5-2 8-3 10-7 0-7-3-7-4-13-2-11 4-22 4-32 1-9-5-10-13-10Zm479 72-4-33c-7-10-11-21-19-28a69 69 0 0 0-42-22c-4 8-11 27-15 31l-20 18c-6 4-9 8-15 11-12 2-23-5-34-7-5-1-12-6-18-3l-4 47c-1 16-2 31-1 47 0 31-5 62 1 93h-1c5 21 12 32 22 41 6 6 16 11 32 15 10 3 21 3 31 0 9-2 12-5 17-9 2-3 10-5 13-1 1 2 3 7 6 8 13 4 26-2 40 2l5-5c2-4 2-11 3-17l-1-65v-32l1-17c1-5 1-12-2-15-6-4-18-2-27-4h-50c-8 0-5 9-6 15l-1 17c1 10 8 11 15 16 2 6-1 14-1 21l-5 33c-1 5-5 6-11 7-5-2-6-3-8-9v-1c-3-15-2-30-2-45l2-46c0-31 2-61 6-91 0-10 14-8 18-5 7 5 1 18 3 26 1 12-3 23 0 34 4 2 9-1 14 0h14c10 0 19 2 29 3 5 1 15 3 14-5 2-8 3-17 1-25ZM910 554c-3-23 0-48-7-70-2-13-3-25-3-38l-5-86c-2-9-7-10-15-11v1c-18 4-35 2-52 4-5 2-7 4-8 10l3 23c-2 31 6 61 6 92 3 20 6 40 7 60 0 28 5 55 6 82 1 6-4 17 3 18 4 1 8-1 11-1 18-3 34-3 51-2 11 1 9-11 8-20-2-21-1-41-5-62Zm183 59-2-14c-6-25-3-50-3-74l-2-42c-1-17 2-33 1-49-2-18-6-37-7-55-11 1-14-5-19-9l-14-14c-4-2-6-10-4-16h-17c-4 0-5 2-7 4 3 17-1 32 1 48 0 16 3 32 4 47 0 4 1 11-3 12l-10-14-7-23c-7-22-14-37-21-53-2-7-1-17-7-17-7-3-14-2-21-3-13 2-31 4-40 9-2 7 2 13 2 19 2 7-1 13-1 19-1 14 2 26 2 39-1 26 9 51 3 77 1 17 3 34 2 51 0 23 0 46 4 68-2 3-4 8-2 9 9 4 17 0 26 0 8-2 17-2 25 1 6 0 9-3 11-6 2-8-2-15 0-23-1-10 2-20-1-30l-3-39c1-7-4-18 3-21l9 18c3 7 5 14 6 22 5 18 11 28 15 44 5 9 2 25 9 28 5 3 12 1 17 1 16 0 35 4 48-4 4-1 3-7 3-10ZM972 225ZM357 436c-2-16-8-34-15-43-8-10-16-18-30-24-18-7-37-5-55-6-22 1-38 10-46 19-12 8-21 17-24 40l-2 117c3 26 1 52 8 78 5 15 10 22 18 30 8 9 17 15 35 20 20 6 39 3 58-1 25-6 34-15 45-27 4-6 10-17 11-29 1-28 2-54 1-81-1-31 0-62-4-93Zm-82 183c-5 0-9-1-8-7-2-8-5-16-4-25l-2-92-2-46v-23c0-8 6-10 14-11v-1c11 0 6 15 9 22 2 17 3 35 3 52v45c3 27 2 53 0 79 1 7-5 6-10 7ZM938 95ZM460 637l-2-15-1-30c-3-20-5-39-5-59 0-13-3-26-5-39-3-17-2-35-3-52-3-23-2-46-6-69-3-5-6-6-13-7-17 5-35 3-52 4-4 2-6 3-8 8-1 9 3 17 2 25l1 25c0 17 5 34 5 50 2 34 9 67 8 100 1 23 6 45 5 67-1 6 0 13 8 11l18-3h43l3-3c4-3 1-9 2-13Zm173-42c-3-17 1-33 0-49-1-21-4-43-2-64v-37l-6-43c0-7 5-14 2-21l-5-24c0-4-6-3-9-2-9 1-17 2-26 1-8 1-22-2-23 6 2 14 0 27 0 40 0 14 2 27 3 40 0 8 4 19 0 25-5-3-7-7-11-12-3-6-4-14-6-21l-14-38c-5-10-11-18-11-32-1-5-10-6-18-6-13-2-27 3-40 5-6 2-9 5-8 13 5 11 2 22 2 34 0 20 4 39 3 59 1 15 5 30 2 45-2 11 1 22 1 34l1 51c1 8-1 16 1 25l2 13c1 4-4 7-2 12 7 4 19 1 28 0l14-1c5 0 8 3 13 2 4-2 6-3 9-9-4-17 0-35-2-53l-5-52c1-3 2-4 4-5l2 2 3 7h1l7 18 5 21c4 12 10 24 13 37 3 7 3 14 4 21 1 6 6 8 14 8 14-2 28 2 41-1 9-2 20-2 17-13l-4-36Z"
      />
      </svg>
    </div>

    <div class="controls">
      <div class="control-group svg-controls">
        <label>Fill:</label>
        <div class="color-picker-wrapper">
          <button type="button" class="color-swatch" id="fill-swatch" style="background: #f49de3;"></button>
          <div class="color-popover" id="fill-popover">
            <button type="button" class="color-option" data-color="#000000">
              <span class="color-preview" style="background: #000000;"></span>
              Black
            </button>
            <button type="button" class="color-option" data-color="#ffffff">
              <span class="color-preview" style="background: #ffffff;"></span>
              White
            </button>
            <button type="button" class="color-option" data-color="#f49de3">
              <span class="color-preview" style="background: #f49de3;"></span>
              Pink
            </button>
            <label class="color-option color-option-custom">
              <span class="color-preview" id="fill-custom-preview" style="background: #f49de3;"></span>
              Custom
              <input type="color" class="color-input-hidden" id="fill-picker" value="#f49de3" />
            </label>
          </div>
        </div>

        <label>Stroke:</label>
        <div class="color-picker-wrapper">
          <button type="button" class="color-swatch" id="stroke-swatch" style="background: #000000;"></button>
          <div class="color-popover" id="stroke-popover">
            <button type="button" class="color-option" data-color="#000000">
              <span class="color-preview" style="background: #000000;"></span>
              Black
            </button>
            <button type="button" class="color-option" data-color="#ffffff">
              <span class="color-preview" style="background: #ffffff;"></span>
              White
            </button>
            <label class="color-option color-option-custom">
              <span class="color-preview" id="stroke-custom-preview" style="background: #000000;"></span>
              Custom
              <input type="color" class="color-input-hidden" id="stroke-picker" value="#000000" />
            </label>
          </div>
        </div>
      </div>

      <div class="control-group svg-controls">
        <label for="stroke-width">Width:</label>
        <input type="range" id="stroke-width" min="0" max="20" value="0" />
        <span class="stroke-width-value" id="stroke-width-value">0</span>
      </div>

      <div class="control-group png-controls" style="display: none;">
        <label>Color:</label>
        <div class="color-picker-wrapper">
          <button type="button" class="color-swatch" id="png-swatch" style="background: #f49de3;"></button>
          <div class="color-popover" id="png-popover">
            <button type="button" class="color-option" data-color="#000000">
              <span class="color-preview" style="background: #000000;"></span>
              Black
            </button>
            <button type="button" class="color-option" data-color="#ffffff">
              <span class="color-preview" style="background: #ffffff;"></span>
              White
            </button>
            <button type="button" class="color-option" data-color="#f49de3">
              <span class="color-preview" style="background: #f49de3;"></span>
              Pink
            </button>
            <label class="color-option color-option-custom">
              <span class="color-preview" id="png-custom-preview" style="background: #f49de3;"></span>
              Custom
              <input type="color" class="color-input-hidden" id="png-color-picker" value="#f49de3" />
            </label>
          </div>
        </div>
      </div>

      <button class="download-btn" id="download-btn">Download PNG</button>
    </div>

    <script>
      const target = document.getElementById("color-target");
      const svg = document.querySelector("svg");
      const pngCanvas = document.getElementById("png-canvas");
      const pngCtx = pngCanvas.getContext("2d");
      const svgControls = document.querySelectorAll(".svg-controls");
      const pngControls = document.querySelectorAll(".png-controls");
      const modeBtns = document.querySelectorAll(".mode-btn");

      let currentMode = "svg";
      let pngImage = null;
      let pngColor = "#f49de3";

      // Load PNG image
      const loadPngImage = () => {
        pngImage = new Image();
        pngImage.onload = () => {
          pngCanvas.width = pngImage.width;
          pngCanvas.height = pngImage.height;
          drawColoredPng();
        };
        pngImage.src = "grunge.png";
      };
      loadPngImage();

      // Draw PNG with color overlay
      const drawColoredPng = () => {
        if (!pngImage) return;

        pngCtx.clearRect(0, 0, pngCanvas.width, pngCanvas.height);

        // Draw original image
        pngCtx.drawImage(pngImage, 0, 0);

        // Apply color using multiply blend mode
        pngCtx.globalCompositeOperation = "source-in";
        pngCtx.fillStyle = pngColor;
        pngCtx.fillRect(0, 0, pngCanvas.width, pngCanvas.height);

        // Reset composite operation
        pngCtx.globalCompositeOperation = "source-over";
      };

      // Mode toggle
      modeBtns.forEach((btn) => {
        btn.addEventListener("click", () => {
          const mode = btn.dataset.mode;
          if (mode === currentMode) return;

          currentMode = mode;
          modeBtns.forEach((b) => b.classList.remove("active"));
          btn.classList.add("active");

          if (mode === "svg") {
            svg.style.display = "";
            pngCanvas.style.display = "none";
            svgControls.forEach((el) => (el.style.display = ""));
            pngControls.forEach((el) => (el.style.display = "none"));
          } else {
            svg.style.display = "none";
            pngCanvas.style.display = "";
            svgControls.forEach((el) => (el.style.display = "none"));
            pngControls.forEach((el) => (el.style.display = ""));
            drawColoredPng();
          }
        });
      });

      // Color picker popover logic
      const setupColorPicker = (swatchId, popoverId, pickerId, customPreviewId, onChange) => {
        const swatch = document.getElementById(swatchId);
        const popover = document.getElementById(popoverId);
        const picker = document.getElementById(pickerId);
        const customPreview = document.getElementById(customPreviewId);

        const updateColor = (color) => {
          swatch.style.background = color;
          customPreview.style.background = color;
          onChange(color);
        };

        // Toggle popover on swatch click
        swatch.addEventListener("click", (e) => {
          e.stopPropagation();
          // Close other popovers
          document.querySelectorAll(".color-popover.open").forEach((p) => {
            if (p !== popover) p.classList.remove("open");
          });
          popover.classList.toggle("open");
        });

        // Handle preset color selection
        popover.querySelectorAll(".color-option[data-color]").forEach((option) => {
          option.addEventListener("click", () => {
            const color = option.dataset.color;
            picker.value = color;
            updateColor(color);
            popover.classList.remove("open");
          });
        });

        // Handle custom color picker change
        picker.addEventListener("input", (e) => {
          updateColor(e.target.value);
        });

        picker.addEventListener("change", () => {
          popover.classList.remove("open");
        });
      };

      // Close popovers when clicking outside
      document.addEventListener("click", (e) => {
        if (!e.target.closest(".color-picker-wrapper")) {
          document.querySelectorAll(".color-popover.open").forEach((p) => {
            p.classList.remove("open");
          });
        }
      });

      // SVG controls
      setupColorPicker("fill-swatch", "fill-popover", "fill-picker", "fill-custom-preview", (color) => {
        target.setAttribute("fill", color);
      });

      setupColorPicker("stroke-swatch", "stroke-popover", "stroke-picker", "stroke-custom-preview", (color) => {
        target.setAttribute("stroke", color);
      });

      document.getElementById("stroke-width").addEventListener("input", (e) => {
        const value = e.target.value;
        target.setAttribute("stroke-width", value);
        document.getElementById("stroke-width-value").textContent = value;
      });

      // PNG controls
      setupColorPicker("png-swatch", "png-popover", "png-color-picker", "png-custom-preview", (color) => {
        pngColor = color;
        drawColoredPng();
      });

      // Download
      document.getElementById("download-btn").addEventListener("click", () => {
        if (currentMode === "png") {
          const pngUrl = pngCanvas.toDataURL("image/png");
          const link = document.createElement("a");
          link.download = "freak-pointing-logo.png";
          link.href = pngUrl;
          link.click();
          return;
        }

        const vb = svg.viewBox.baseVal;
        const strokeWidth = parseInt(target.getAttribute("stroke-width")) || 0;
        const padding = 40 + strokeWidth;

        // Expand viewBox to account for stroke width
        const newViewBox = `${vb.x - padding} ${vb.y - padding} ${vb.width + padding * 2} ${vb.height + padding * 2}`;
        const canvasWidth = vb.width + padding * 2;
        const canvasHeight = vb.height + padding * 2;

        // Clone SVG and set explicit dimensions for proper rasterization
        const svgClone = svg.cloneNode(true);
        svgClone.setAttribute("viewBox", newViewBox);
        svgClone.setAttribute("width", canvasWidth);
        svgClone.setAttribute("height", canvasHeight);

        const svgData = new XMLSerializer().serializeToString(svgClone);
        const svgBlob = new Blob([svgData], { type: "image/svg+xml;charset=utf-8" });
        const url = URL.createObjectURL(svgBlob);

        const img = new Image();
        img.onload = () => {
          const canvas = document.createElement("canvas");
          canvas.width = canvasWidth;
          canvas.height = canvasHeight;

          const ctx = canvas.getContext("2d");
          ctx.drawImage(img, 0, 0);
          URL.revokeObjectURL(url);

          const pngUrl = canvas.toDataURL("image/png");
          const link = document.createElement("a");
          link.download = "freak-pointing-logo.png";
          link.href = pngUrl;
          link.click();
        };
        img.src = url;
      });
    </script>
  </body>
</html>
